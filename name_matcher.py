'''
NBANameMatcher.py
Reconcile names between various sites (example: dougstats and espn)
'''

import pandas as pd
from fuzzywuzzy import fuzz, process

class NBANameMatcher:
   
    def espn_doug (self, espn_names, doug_names):

        matched_names = []
        
        for name in espnnames:


            if name in _espn_doug:
                matched.append([name, _espn_doug.get(name, None)])

            else:
                parts = name.split(' ')

                if len(parts) > 1:
                    dougname = '{0},{1}'.format(parts[1], parts[0])
                    dougname = dougname[0:16].lower()
                    matched.append(match_player(dougname, dougnames))

        return matched

    def match_player (self, to_match, match_from, threshold):

        match = None

        # first see if there is a direct match
        if to_match in match_from:
            match = to_match

        # if still no match, then try fuzzy matching
        if not match:
            name, confidence = process.extractOne(to_match, match_from)

            if confidence >= threshold:
                match = name

        return [to_match, match]

    _espn_doug = {"Andrew Nicholson": "nicholson,andrew", "Boris Diaw": "diaw,boris", "JaVale McGee": "mcgee,javale", "Jordan Hamilton": "hamilton,jordan", "Chris Johnson": "johnson,chris", "Ryan Anderson": "anderson,ryan", "Marcus Smart": "smart,marcus", "John Wall": "wall,john", "Kevin Love": "love,kevin", "Tony Wroten": "wroten,tony", "Solomon Hill": "hill,solomon", "Raymond Felton": "felton,raymond", "Patty Mills": "mills,patty", "Alex Len": "len,alex", "Monta Ellis": "ellis,monta", "Thaddeus Young": "young,thaddeus", "Kobe Bryant": "bryant,kobe", "Jason Richardson": "richardson,jason", "Eric Gordon": "gordon,eric", "Dwight Howard": "howard,dwight", "Wilson Chandler": "chandler,wilson", "Jeff Green": "green,jeff", "Tyler Ennis": "ennis,tyler", "Isaiah Thomas": "thomas,isaiah", "Jeff Teague": "teague,jeff", "Rodney Hood": "hood,rodney", "Jimmer Fredette": "fredette,jimmer", "Victor Oladipo": "oladipo,victor", "Gerald Henderson": "henderson,gerald", "Andre Drummond": "drummond,andre", "Eric Bledsoe": "bledsoe,eric", "Trevor Ariza": "ariza,trevor", "Gary Harris": "harris,gary", "Deron Williams": "williams,deron", "Chris Bosh": "bosh,chris", "Doug McDermott": "mcdermott,doug", "Rajon Rondo": "rondo,rajon", "Anthony Davis": "davis,anthony", "Adreian Payne": "payne,adreian", "Ricky Rubio": "rubio,ricky", "Matt Barnes": "barnes,matt", "Elliot Williams": "williams,elliot", "Festus Ezeli": "ezeli,festus", "C.J. McCollum": "mccollum,c.j.", "Mo Williams": "williams,mo", "Nikola Mirotic": "mirotic,nikola", "Pablo Prigioni": "prigioni,pablo", "Tyler Zeller": "zeller,tyler", "Mason Plumlee": "plumlee,mason", "Ian Mahinmi": "mahinmi,ian", "Tyler Johnson": "johnson,tyler", "Tobias Harris": "harris,tobias", "Ben McLemore": "mclemore,ben", "Thomas Robinson": "robinson,thomas", "DeMarcus Cousins": "cousins,demarcus", "Josh Richardson": "smith,josh", "Anthony Morrow": "morrow,anthony", "Enes Kanter": "kanter,enes", "Zach LaVine": "lavine,zach", "Louis Williams": "williams,louis", "Matthew Dellavedova": "dellavedova,matt", "Anderson Varejao": "varejao,anderson", "Kevin Garnett": "garnett,kevin", "Luke Babbitt": "babbitt,luke", "James Johnson": "johnson,james", "Robert Covington": "covington,robert", "Kelly Olynyk": "olynyk,kelly", "Ty Lawson": "lawson,ty", "Steve Novak": "novak,steve", "Sergey Karasev": "karasev,sergey", "Quincy Pondexter": "pondexter,quincy", "Greivis Vasquez": "vasquez,greivis", "Ersan Ilyasova": "ilyasova,ersan", "Evan Turner": "turner,evan", "Kemba Walker": "walker,kemba", "Serge Ibaka": "ibaka,serge", "Marcin Gortat": "gortat,marcin", "Andre Iguodala": "iguodala,andre", "Robin Lopez": "lopez,robin", "Kentavious Caldwell-Pope": "caldwell-pope,ke", "David West": "west,david", "Jordan Adams": "adams,jordan", "Leandro Barbosa": "barbosa,leandro", "Henry Walker": "walker,henry", "Corey Brewer": "brewer,corey", "Shelvin Mack": "mack,shelvin", "Gorgui Dieng": "dieng,gorgui", "Terrence Jones": "jones,terrence", "Andrew Bogut": "bogut,andrew", "Paul George": "george,paul", "John Jenkins": "jenkins,john", "Andrew Wiggins": "wiggins,andrew", "Brandon Bass": "bass,brandon", "Jabari Parker": "parker,jabari", "Wayne Ellington": "ellington,wayne", "Danny Green": "green,danny", "Jamal Crawford": "crawford,jamal", "Cole Aldrich": "aldrich,cole", "Stephen Curry": "curry,stephen", "Michael Kidd-Gilchrist": "kidd-gilchrist,m", "DeJuan Blair": "blair,dejuan", "Giannis Antetokounmpo": "antetokounmpo,g", "Jusuf Nurkic": "nurkic,jusuf", "Steven Adams": "adams,steven", "Marvin Williams": "williams,marvin", "Nikola Vucevic": "vucevic,nikola", "P.J. Hairston": "hairston,p.j.", "Udonis Haslem": "haslem,udonis", "Wesley Johnson": "johnson,wesley", "James Young": "young,james", "Anthony Brown": "morrow,anthony", "Spencer Hawes": "hawes,spencer", "Kevin Durant": "durant,kevin", "Tiago Splitter": "splitter,tiago", "Dante Exum": "exum,dante", "Vince Carter": "carter,vince", "Michael Carter-Williams": "carter-williams", "Archie Goodwin": "goodwin,archie", "Alan Anderson": "anderson,alan", "Joakim Noah": "noah,joakim", "Gordon Hayward": "hayward,gordon", "Austin Rivers": "rivers,austin", "Tony Allen": "allen,tony", "Nicolas Batum": "batum,nicolas", "Will Barton": "barton,will", "Troy Daniels": "daniels,troy", "Carl Landry": "landry,carl", "Trevor Booker": "booker,trevor", "Donatas Motiejunas": "motiejunas,donat", "P.J. Tucker": "tucker,p.j.", "Jae Crowder": "crowder,jae", "Al Horford": "horford,al", "Jerryd Bayless": "bayless,jerryd", "Ray McCallum": "mccallum,ray", "Lance Stephenson": "stephenson,lance", "Kyle O'Quinn": "o'quinn,kyle", "Nick Collison": "collison,nick", "Julius Randle": "randle,julius", "Chris McCullough": "bosh,chris", "Darrell Arthur": "arthur,darrell", "Caron Butler": "butler,caron", "Gary Neal": "neal,gary", "Omri Casspi": "casspi,omri", "Nikola Pekovic": "pekovic,nikola", "Dion Waiters": "waiters,dion", "Blake Griffin": "griffin,blake", "Noah Vonleh": "vonleh,noah", "Tim Duncan": "duncan,tim", "Otto Porter Jr.": "porter,otto", "J.J. Barea": "barea,j.j.", "Jose Calderon": "calderon,jose", "Randy Foye": "foye,randy", "Jared Dudley": "dudley,jared", "Kyle Korver": "korver,kyle", "DeMarre Carroll": "carroll,demarre", "Ryan Kelly": "kelly,ryan", "Elfrid Payton": "payton,elfrid", "Steve Blake": "blake,steve", "Brian Roberts": "roberts,brian", "Jon Leuer": "leuer,jon", "Jonas Jerebko": "jerebko,jonas", "Jameer Nelson": "nelson,jameer", "Jarnell Stokes": "stokes,jarnell", "Furkan Aldemir": "aldemir,furkan", "Jason Thompson": "thompson,jason", "Derrick Rose": "rose,derrick", "Lance Thomas": "thomas,lance", "Rudy Gobert": "gobert,rudy", "Meyers Leonard": "leonard,meyers", "Alexis Ajinca": "ajinca,alexis", "Jrue Holiday": "holiday,jrue", "Mirza Teletovic": "teletovic,mirza", "Nik Stauskas": "stauskas,nik", "Timofey Mozgov": "mozgov,timofey", "Aaron Brooks": "brooks,aaron", "Phil Pressey": "pressey,phil", "Jimmy Butler": "butler,jimmy", "Perry Jones": "jones,perry", "C.J. Wilcox": "wilcox,c.j.", "Dante Cunningham": "cunningham,dante", "Maurice Harkless": "harkless,maurice", "Andrea Bargnani": "bargnani,andrea", "Jonas Valanciunas": "valanciunas,jona", "Jeremy Lamb": "lamb,jeremy", "Trey Burke": "burke,trey", "Thabo Sefolosha": "sefolosha,thabo", "Chris Kaman": "kaman,chris", "Cory Jefferson": "jefferson,cory", "Avery Bradley": "bradley,avery", "James Harden": "harden,james", "DeMar DeRozan": "derozan,demar", "Klay Thompson": "thompson,klay", "Damjan Rudez": "rudez,damjan", "Jerian Grant": "grant,jerami", "Pau Gasol": "gasol,pau", "Kris Humphries": "humphries,kris", "Carmelo Anthony": "anthony,carmelo", "C.J. Miles": "miles,c.j.", "Joffrey Lauvergne": "lauvergne,joffre", "David Lee": "lee,david", "Kyle Singler": "singler,kyle", "Kawhi Leonard": "leonard,kawhi", "Elijah Millsap": "millsap,elijah", "Kosta Koufos": "koufos,kosta", "Bismack Biyombo": "biyombo,bismack", "Brandon Rush": "rush,brandon", "C.J. Watson": "watson,c.j.", "Zach Randolph": "randolph,zach", "Kendall Marshall": "marshall,kendall", "Luis Scola": "scola,luis", "Mike Conley": "conley,mike", "LeBron James": "james,lebron", "J.J. Redick": "redick,j.j.", "Aaron Gordon": "gordon,aaron", "Courtney Lee": "lee,courtney", "Nerlens Noel": "noel,nerlens", "Tim Hardaway Jr.": "hardaway,tim", "Patrick Beverley": "beverley,patrick", "Devin Harris": "harris,devin", "LaMarcus Aldridge": "aldridge,lamarcu", "Chris Copeland": "copeland,chris", "Draymond Green": "green,draymond", "Joe Johnson": "johnson,joe", "T.J. Warren": "warren,t.j.", "Kevin Martin": "martin,kevin", "Dirk Nowitzki": "nowitzki,dirk", "Kenneth Faried": "faried,kenneth", "Kyle Lowry": "lowry,kyle", "E'Twaun Moore": "moore,e'twaun", "Dennis Schroder": "schroder,dennis", "Joe Ingles": "ingles,joe", "Evan Fournier": "fournier,evan", "Rodney Stuckey": "stuckey,rodney", "Russell Westbrook": "westbrook,russel", "Reggie Jackson": "jackson,reggie", "Terrence Ross": "ross,terrence", "Shane Larkin": "larkin,shane", "Paul Pierce": "pierce,paul", "Joey Dorsey": "dorsey,joey", "Norris Cole": "cole,norris", "Earl Clark": "clark,earl", "Chris Paul": "paul,chris", "Kirk Hinrich": "hinrich,kirk", "Drew Gooden": "gooden,drew", "Josh McRoberts": "mcroberts,josh", "Andre Roberson": "roberson,andre", "Channing Frye": "frye,channing", "Marc Gasol": "gasol,marc", "Ramon Sessions": "sessions,ramon", "Jared Sullinger": "sullinger,jared", "Miles Plumlee": "plumlee,miles", "K.J. McDaniels": "mcdaniels,k.j.", "Lavoy Allen": "allen,lavoy", "Omer Asik": "asik,omer", "Harrison Barnes": "barnes,harrison", "Alonzo Gee": "gee,alonzo", "Bradley Beal": "beal,bradley", "Reggie Bullock": "bullock,reggie", "Iman Shumpert": "shumpert,iman", "Kent Bazemore": "bazemore,kent", "Goran Dragic": "dragic,goran", "Ed Davis": "davis,ed", "Tyreke Evans": "evans,tyreke", "Nick Young": "young,nick", "Cory Joseph": "joseph,cory", "Ryan Hollins": "hollins,ryan", "Danilo Gallinari": "gallinari,danilo", "Khris Middleton": "middleton,khris", "Mitch McGary": "mcgary,mitch", "Kostas Papanikolaou": "papanikolaou,kos", "Glenn Robinson III": "robinson,glenn", "Chris Andersen": "andersen,chris", "Anthony Tolliver": "tolliver,anthony", "Darren Collison": "collison,darren", "Shabazz Muhammad": "muhammad,shabazz", "Lou Amundson": "amundson,lou", "Markieff Morris": "morris,markieff", "D.J. Augustin": "augustin,d.j.", "Derrick Williams": "williams,derrick", "Mike Dunleavy": "dunleavy,mike", "Marco Belinelli": "belinelli,marco", "Patrick Patterson": "patterson,patric", "Alec Burks": "burks,alec", "Dwyane Wade": "wade,dwyane", "Rondae Hollis-Jefferson": "jefferson,al", "Reggie Williams": "williams,reggie", "Aron Baynes": "baynes,aron", "Stanley Johnson": "johnson,wesley", "Chandler Parsons": "parsons,chandler", "Damian Lillard": "lillard,damian", "Brandon Jennings": "jennings,brandon", "Mike Scott": "scott,mike", "Mario Chalmers": "chalmers,mario", "Kyle Anderson": "anderson,kyle", "Paul Millsap": "millsap,paul", "Bojan Bogdanovic": "bogdanovic,bojan", "Brandan Wright": "wright,brandan", "J.J. Hickson": "hickson,j.j.", "Jarrett Jack": "jack,jarrett", "JaMychal Green": "green,jamychal", "Quincy Acy": "acy,quincy", "Tim Frazier": "frazier,tim", "Luke Ridnour": "ridnour,luke", "John Henson": "henson,john", "Allen Crabbe": "crabbe,allen", "Cody Zeller": "zeller,cody", "Martell Webster": "webster,martell", "Luol Deng": "deng,luol", "Manu Ginobili": "ginobili,manu", "Beno Udrih": "udrih,beno", "Joel Anthony": "anthony,joel", "Jeremy Lin": "lin,jeremy", "Brendan Haywood": "haywood,brendan", "Shabazz Napier": "napier,shabazz", "Al Jefferson": "jefferson,al", "Marreese Speights": "speights,marrees", "Gerald Wallace": "wallace,gerald", "Tyler Hansbrough": "hansbrough,tyler", "Jason Smith": "smith,jason", "Tony Snell": "snell,tony", "Zaza Pachulia": "pachulia,zaza", "Al-Farouq Aminu": "aminu,al-farouq", "Tyson Chandler": "chandler,tyson", "Rudy Gay": "gay,rudy", "Arron Afflalo": "afflalo,arron", "Roy Hibbert": "hibbert,roy", "Tony Parker": "parker,tony", "Garrett Temple": "temple,garrett", "Jodie Meeks": "meeks,jodie"}

if __name__ == '__main__':
    pass
    #m = NBANameMatcher()
